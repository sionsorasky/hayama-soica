<!doctype html>
<html lang="ja" class="h-full">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Soica - Roblox鉄道icカード</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500;700&amp;family=Outfit:wght@300;400;500;600;700&amp;display=swap" rel="stylesheet">
  <script src="/_sdk/element_sdk.js"></script>
  <style>
    body {
      box-sizing: border-box;
    }
    * {
      font-family: 'Outfit', 'Noto Sans JP', sans-serif;
    }
    .glow {
      box-shadow: 0 0 60px rgba(99, 102, 241, 0.3), 0 0 100px rgba(139, 92, 246, 0.2);
    }
    @keyframes float {
      0%, 100% { transform: translateY(0) rotateY(-15deg) rotateX(5deg); }
      50% { transform: translateY(-20px) rotateY(-15deg) rotateX(5deg); }
    }
    .float-animation {
      animation: float 4s ease-in-out infinite;
    }
    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    .fade-in-up {
      animation: fadeInUp 0.8s ease-out forwards;
    }
    .delay-1 { animation-delay: 0.1s; }
    .delay-2 { animation-delay: 0.2s; }
    .delay-3 { animation-delay: 0.3s; }
    .delay-4 { animation-delay: 0.4s; }
    .delay-5 { animation-delay: 0.5s; }
  </style>
  <style>@view-transition { navigation: auto; }</style>
  <script src="/_sdk/data_sdk.js" type="text/javascript"></script>
</head>
<body class="h-full bg-slate-950 text-white overflow-auto">
<div class="min-h-full w-full"><!-- ナビゲーション -->
  <nav class="fixed top-0 left-0 right-0 z-50 bg-slate-950/80 backdrop-blur-md border-b border-slate-800/50">
    <div class="max-w-6xl mx-auto px-6 py-4 flex justify-between items-center">
      <div class="flex items-center gap-2">
        <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center"><span class="text-white font-bold text-sm">S</span>
        </div><span id="nav-logo" class="text-xl font-semibold tracking-tight">Soica</span>
      </div><button id="nav-balance-btn" class="px-5 py-2 bg-indigo-600 hover:bg-indigo-500 rounded-full text-sm font-medium transition-all duration-300 hover:shadow-lg hover:shadow-indigo-500/30"> 残高確認 </button>
    </div>
  </nav><!-- ヒーローセクション -->
  <section class="min-h-screen flex items-center justify-center px-6 pt-20 pb-16">
    <div class="max-w-6xl w-full mx-auto grid lg:grid-cols-2 gap-12 items-center"><!-- テキストコンテンツ -->
      <div class="text-center lg:text-left opacity-0 fade-in-up">
        <div class="inline-flex items-center gap-2 px-4 py-2 bg-indigo-500/10 border border-indigo-500/30 rounded-full mb-6"><span class="w-2 h-2 bg-emerald-400 rounded-full animate-pulse"></span> <span class="text-sm text-indigo-300">新サイトリリース</span>
        </div>
        <h1 id="hero-title" class="text-5xl lg:text-7xl font-bold mb-6 bg-gradient-to-r from-white via-indigo-200 to-purple-300 bg-clip-text text-transparent">Soica</h1>
        <p id="hero-subtitle" class="text-xl lg:text-2xl text-slate-400 mb-8 leading-relaxed">スマートな暮らしを、あなたの手に</p>
        <div class="flex flex-col sm:flex-row gap-4 justify-center lg:justify-start"><button id="hero-balance-btn" class="group px-8 py-4 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-500 hover:to-purple-500 rounded-xl font-semibold text-lg transition-all duration-300 hover:shadow-xl hover:shadow-indigo-500/30 flex items-center justify-center gap-3"> <span>残高を確認する</span>
          <svg class="w-5 h-5 group-hover:translate-x-1 transition-transform" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"></path>
          </svg></button> <button class="px-8 py-4 border border-slate-700 hover:border-slate-500 rounded-xl font-semibold text-lg transition-all duration-300 hover:bg-slate-800/50"> 詳しく見る </button>
        </div>
      </div><!-- カードビジュアル -->
      <div class="flex justify-center lg:justify-end opacity-0 fade-in-up delay-2" style="perspective: 1000px;">
        <div class="relative float-animation"><img src="https://i.imgur.com/sUMhLw1.png" alt="Soica Card" class="w-80 h-auto rounded-2xl glow shadow-2xl" onerror="this.style.display='none'; this.alt='画像の読み込みに失敗しました';"> <!-- 背景の装飾 -->
          <div class="absolute -z-10 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-96 h-96 bg-indigo-500/20 rounded-full blur-3xl"></div>
        </div>
      </div>
    </div>
  </section><!-- 特徴セクション -->
  <section class="py-24 px-6 bg-gradient-to-b from-slate-950 to-slate-900">
    <div class="max-w-6xl mx-auto">
      <div class="text-center mb-16 opacity-0 fade-in-up delay-1">
        <h2 class="text-3xl lg:text-4xl font-bold mb-4">Soicaの特徴</h2>
        <p class="text-slate-400 text-lg">ロブ鉄をもっと便利に、もっと簡単に</p>
      </div>
      <div class="grid md:grid-cols-3 gap-8"><!-- 特徴1 -->
        <div class="group p-8 bg-slate-800/30 border border-slate-700/50 rounded-2xl hover:border-indigo-500/50 transition-all duration-500 hover:shadow-xl hover:shadow-indigo-500/10 opacity-0 fade-in-up delay-2">
          <div class="w-14 h-14 bg-gradient-to-br from-indigo-500 to-purple-600 rounded-xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300">
            <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path>
            </svg>
          </div>
          <h3 id="feature1-title" class="text-xl font-semibold mb-3">いつでも確認</h3>
          <p class="text-slate-400 leading-relaxed">サイトからいつでも残高を確認できます。</p>
        </div><!-- 特徴2 -->
        <div class="group p-8 bg-slate-800/30 border border-slate-700/50 rounded-2xl hover:border-emerald-500/50 transition-all duration-500 hover:shadow-xl hover:shadow-emerald-500/10 opacity-0 fade-in-up delay-3">
          <div class="w-14 h-14 bg-gradient-to-br from-emerald-500 to-teal-600 rounded-xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300">
            <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
            </svg>
          </div>
          <h3 id="feature2-title" class="text-xl font-semibold mb-3">かんたん決済</h3>
          <p class="text-slate-400 leading-relaxed">タッチするだけで電車の乗車からコンビニでの買い物まであらゆることができます。</p>
        </div><!-- 特徴3 -->
        <div class="group p-8 bg-slate-800/30 border border-slate-700/50 rounded-2xl hover:border-rose-500/50 transition-all duration-500 hover:shadow-xl hover:shadow-rose-500/10 opacity-0 fade-in-up delay-4">
          <div class="w-14 h-14 bg-gradient-to-br from-rose-500 to-orange-600 rounded-xl flex items-center justify-center mb-6 group-hover:scale-110 transition-transform duration-300">
            <svg class="w-7 h-7 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
            </svg>
          </div>
          <h3 id="feature3-title" class="text-xl font-semibold mb-3">安心セキュリティ</h3>
          <p class="text-slate-400 leading-relaxed">サイトから残高を変更できないので、安心です。</p>
        </div>
      </div>
    </div>
  </section><!-- フッター -->
  <footer class="py-12 px-6 bg-slate-950 border-t border-slate-800/50">
    <div class="max-w-6xl mx-auto text-center">
      <div class="flex items-center justify-center gap-2 mb-6">
        <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center"><span class="text-white font-bold text-sm">S</span>
        </div><span class="text-xl font-semibold">Soica</span>
      </div>
      <p class="text-slate-500 text-sm">© 2024 Soica. All rights reserved.</p>
    </div>
  </footer>
</div><!-- 残高確認モーダル -->
<div id="balance-modal" class="fixed inset-0 z-50 hidden items-center justify-center p-6 bg-slate-950/80 backdrop-blur-sm">
  <div class="bg-slate-900 border border-slate-700 rounded-3xl p-8 max-w-md w-full transform transition-all duration-300 scale-95 opacity-0" id="modal-content">
    <div class="flex justify-between items-center mb-6">
      <h3 class="text-xl font-semibold">Hayama Soica残高確認</h3><button id="close-modal" class="w-10 h-10 rounded-full bg-slate-800 hover:bg-slate-700 flex items-center justify-center transition-colors">
      <svg class="w-5 h-5" fill="none" stroke="currentColor" viewbox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg></button>
    </div>
    <form id="balance-form" class="mb-6"><label for="user-id-input" class="block text-sm text-slate-400 mb-2">ユーザーID</label> <input type="text" id="user-id-input" placeholder="完全なユーザーIDを入力" autocomplete="off" class="w-full px-4 py-3 bg-slate-800 border border-slate-700 rounded-xl text-white placeholder-slate-500 focus:outline-none focus:border-indigo-500 transition-colors mb-4"> <button type="submit" class="w-full py-3 bg-indigo-600 hover:bg-indigo-500 rounded-xl font-semibold transition-colors"> 残高確認 </button>
    </form>
    <div id="balance-result" class="text-center py-4 hidden">
      <div class="text-sm text-slate-400 mb-2">
        カード残高
      </div>
      <div id="balance-amount" class="text-5xl font-bold text-emerald-400 mb-2">
      </div>
      <div id="balance-message" class="text-sm text-slate-400"></div>
    </div>
  </div>
</div>
<script>
  const defaultConfig = {
    hero_title: 'Soica',
    hero_subtitle: 'スマートな暮らしを、あなたの手に',
    feature1_title: 'かんたん決済',
    feature2_title: 'ポイント還元',
    feature3_title: '安心セキュリティ',
    balance_button_text: '残高を確認する',
    background_color: '#020617',
    surface_color: '#1e293b',
    text_color: '#ffffff',
    primary_action_color: '#4f46e5',
    secondary_action_color: '#6366f1'
  };

  async function onConfigChange(config) {
    const heroTitle = document.getElementById('hero-title');
    const heroSubtitle = document.getElementById('hero-subtitle');
    const feature1Title = document.getElementById('feature1-title');
    const feature2Title = document.getElementById('feature2-title');
    const feature3Title = document.getElementById('feature3-title');
    const heroBalanceBtn = document.getElementById('hero-balance-btn');
    const navLogo = document.getElementById('nav-logo');

    if (heroTitle) heroTitle.textContent = config.hero_title || defaultConfig.hero_title;
    if (heroSubtitle) heroSubtitle.textContent = config.hero_subtitle || defaultConfig.hero_subtitle;
    if (feature1Title) feature1Title.textContent = config.feature1_title || defaultConfig.feature1_title;
    if (feature2Title) feature2Title.textContent = config.feature2_title || defaultConfig.feature2_title;
    if (feature3Title) feature3Title.textContent = config.feature3_title || defaultConfig.feature3_title;
    if (heroBalanceBtn) {
      const btnText = heroBalanceBtn.querySelector('span');
      if (btnText) btnText.textContent = config.balance_button_text || defaultConfig.balance_button_text;
    }

    const bgColor = config.background_color || defaultConfig.background_color;
    const surfaceColor = config.surface_color || defaultConfig.surface_color;
    const textColor = config.text_color || defaultConfig.text_color;
    const primaryColor = config.primary_action_color || defaultConfig.primary_action_color;
    const secondaryColor = config.secondary_action_color || defaultConfig.secondary_action_color;

    document.body.style.backgroundColor = bgColor;
    document.body.style.color = textColor;

    const featureCards = document.querySelectorAll('.group.p-8');
    featureCards.forEach(card => {
      card.style.backgroundColor = surfaceColor + '4d';
    });

    const primaryButtons = document.querySelectorAll('.bg-indigo-600, .from-indigo-600');
    primaryButtons.forEach(btn => {
      btn.style.backgroundColor = primaryColor;
    });

    const navBalanceBtn = document.getElementById('nav-balance-btn');
    if (navBalanceBtn) {
      navBalanceBtn.style.backgroundColor = secondaryColor;
    }
  }

  function mapToCapabilities(config) {
    return {
      recolorables: [
        {
          get: () => config.background_color || defaultConfig.background_color,
          set: (value) => {
            config.background_color = value;
            if (window.elementSdk) window.elementSdk.setConfig({ background_color: value });
          }
        },
        {
          get: () => config.surface_color || defaultConfig.surface_color,
          set: (value) => {
            config.surface_color = value;
            if (window.elementSdk) window.elementSdk.setConfig({ surface_color: value });
          }
        },
        {
          get: () => config.text_color || defaultConfig.text_color,
          set: (value) => {
            config.text_color = value;
            if (window.elementSdk) window.elementSdk.setConfig({ text_color: value });
          }
        },
        {
          get: () => config.primary_action_color || defaultConfig.primary_action_color,
          set: (value) => {
            config.primary_action_color = value;
            if (window.elementSdk) window.elementSdk.setConfig({ primary_action_color: value });
          }
        },
        {
          get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
          set: (value) => {
            config.secondary_action_color = value;
            if (window.elementSdk) window.elementSdk.setConfig({ secondary_action_color: value });
          }
        }
      ],
      borderables: [],
      fontEditable: {
        get: () => config.font_family || 'Outfit',
        set: (value) => {
          config.font_family = value;
          if (window.elementSdk) window.elementSdk.setConfig({ font_family: value });
        }
      },
      fontSizeable: {
        get: () => config.font_size || 16,
        set: (value) => {
          config.font_size = value;
          if (window.elementSdk) window.elementSdk.setConfig({ font_size: value });
        }
      }
    };
  }

  function mapToEditPanelValues(config) {
    return new Map([
      ['hero_title', config.hero_title || defaultConfig.hero_title],
      ['hero_subtitle', config.hero_subtitle || defaultConfig.hero_subtitle],
      ['feature1_title', config.feature1_title || defaultConfig.feature1_title],
      ['feature2_title', config.feature2_title || defaultConfig.feature2_title],
      ['feature3_title', config.feature3_title || defaultConfig.feature3_title],
      ['balance_button_text', config.balance_button_text || defaultConfig.balance_button_text]
    ]);
  }

  if (window.elementSdk) {
    window.elementSdk.init({
      defaultConfig,
      onConfigChange,
      mapToCapabilities,
      mapToEditPanelValues
    });
  }

  // モーダル機能
  const modal = document.getElementById('balance-modal');
  const modalContent = document.getElementById('modal-content');
  const closeBtn = document.getElementById('close-modal');
  const navBalanceBtn = document.getElementById('nav-balance-btn');
  const heroBalanceBtn = document.getElementById('hero-balance-btn');
  const balanceForm = document.getElementById('balance-form');
  const userIdInput = document.getElementById('user-id-input');
  const balanceResult = document.getElementById('balance-result');
  const balanceAmount = document.getElementById('balance-amount');
  const balanceMessage = document.getElementById('balance-message');

  function openModal() {
    modal.classList.remove('hidden');
    modal.classList.add('flex');
    setTimeout(() => {
      modalContent.classList.remove('scale-95', 'opacity-0');
      modalContent.classList.add('scale-100', 'opacity-100');
    }, 10);
    // フォームをリセット
    balanceResult.classList.add('hidden');
    userIdInput.value = '';
  }

  function closeModal() {
    modalContent.classList.remove('scale-100', 'opacity-100');
    modalContent.classList.add('scale-95', 'opacity-0');
    setTimeout(() => {
      modal.classList.add('hidden');
      modal.classList.remove('flex');
    }, 300);
  }

  navBalanceBtn.addEventListener('click', openModal);
  heroBalanceBtn.addEventListener('click', openModal);
  closeBtn.addEventListener('click', closeModal);
  modal.addEventListener('click', (e) => {
    if (e.target === modal) closeModal();
  });

  // 残高確認フォーム送信
  balanceForm.addEventListener('submit', (e) => {
    e.preventDefault();
    const userId = userIdInput.value.trim();

    if (!userId) {
      balanceResult.classList.remove('hidden');
      balanceAmount.textContent = '';
      balanceMessage.textContent = '正しい値を入力してください';
      balanceMessage.style.color = '#ef4444';
      return;
    }

    // ローディング表示
    balanceResult.classList.remove('hidden');
    balanceAmount.textContent = '検索中...';
    balanceAmount.className = 'text-5xl font-bold text-slate-400 mb-2';
    balanceMessage.textContent = '';

    // API呼び出し
    fetch(`https://script.google.com/macros/s/AKfycbzZ66QEJ_KrcOUlmdRvihSGqQ6s7vVzOOS9qBYCqpgyEVKx2vP61zPwDcsBoriloc4h/exec?b=${encodeURIComponent(userId)}`)
      .then(response => response.json())
      .then(data => {
        if (data.result !== null) {
          balanceAmount.textContent = `¥${data.result}`;
          balanceAmount.className = 'text-5xl font-bold text-emerald-400 mb-2';
          balanceMessage.textContent = 'Hayama Soica残高';
          balanceMessage.style.color = '#94a3b8';
        } else {
          balanceAmount.textContent = '';
          balanceMessage.textContent = '未参加かユーザーIDが間違っています';
          balanceMessage.style.color = '#ef4444';
        }
      })
      .catch(err => {
        balanceAmount.textContent = '';
        balanceMessage.textContent = 'エラーが発生しました';
        balanceMessage.style.color = '#ef4444';
        console.error(err);
      });
  });

  // フェードインアニメーションの監視
  const observer = new IntersectionObserver((entries) => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        entry.target.classList.remove('opacity-0');
      }
    });
  }, { threshold: 0.1 });

  document.querySelectorAll('.fade-in-up').forEach(el => {
    observer.observe(el);
  });
</script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9bc4ab0b774bf2d6',t:'MTc2ODEzNzE3Mi4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
